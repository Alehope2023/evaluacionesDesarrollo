{"ast":null,"code":"import _objectSpread from\"C:/trabajo/Alehope/actividadesPreBuild/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{format}from'date-fns';import DeleteActionModal from'components/ReactTableActions/Delete/DeleteActionModal';import ActiveAndDesactiveActionModal from'components/ReactTableActions/ActiveAndDesactive/ActiveAndDesactiveActionModal';import{deleteProfile,profileUpdateInfo}from'redux/actions/profileActions';import{USER_LIST_BY_PROFILE_ID_RESET}from'redux/constants/userConstants';import{PROFILE_LIST_RESET,PROFILE_DELETE_RESET,PROFILE_UPDATE_RESET}from'redux/constants/profileConstants';import{getUsersByProfileId}from'redux/actions/userActions';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DeleteProfileModal=function DeleteProfileModal(_ref){var handleCloseDeleteProfileModal=_ref.handleCloseDeleteProfileModal,deleteProfileModal=_ref.deleteProfileModal,showDeleteProfileInfo=_ref.showDeleteProfileInfo;var dispatch=useDispatch();var active=showDeleteProfileInfo.activo!=='SI';var _useSelector=useSelector(function(state){return state.profileDelete;}),successProfileDelete=_useSelector.successProfileDelete,errorProfileDelete=_useSelector.errorProfileDelete,loadingProfileDelete=_useSelector.loadingProfileDelete;var _useSelector2=useSelector(function(state){return state.userListByProfileId;}),loadingUserListByProfileId=_useSelector2.loadingUserListByProfileId,userListByProfileIdData=_useSelector2.userListByProfileIdData;var _useSelector3=useSelector(function(state){return state.profileUpdate;}),loadingProfileUpdate=_useSelector3.loadingProfileUpdate,errorProfileUpdate=_useSelector3.errorProfileUpdate,successProfileUpdate=_useSelector3.successProfileUpdate;useEffect(function(){var timeOut='';if(successProfileUpdate){dispatch({type:PROFILE_LIST_RESET});timeOut=setTimeout(function(){dispatch({type:PROFILE_UPDATE_RESET});handleCloseDeleteProfileModal();},1000);}return function(){return clearTimeout(timeOut);};},[successProfileUpdate]);useEffect(function(){dispatch(getUsersByProfileId(showDeleteProfileInfo.id_perfil));},[]);useEffect(function(){var timeOut='';if(successProfileDelete){timeOut=setTimeout(function(){dispatch({type:PROFILE_LIST_RESET});dispatch({type:PROFILE_DELETE_RESET});handleCloseDeleteProfileModal();},1000);}return function(){return clearTimeout(timeOut);};},[successProfileDelete]);useEffect(function(){return function(){return dispatch({type:PROFILE_DELETE_RESET});};},[dispatch]);useEffect(function(){return function(){return dispatch({type:PROFILE_UPDATE_RESET});};},[dispatch]);useEffect(function(){return function(){return dispatch({type:USER_LIST_BY_PROFILE_ID_RESET});};},[dispatch]);var handleDeleteProfile=function handleDeleteProfile(e){e.preventDefault();dispatch(deleteProfile(showDeleteProfileInfo===null||showDeleteProfileInfo===void 0?void 0:showDeleteProfileInfo.id_perfil));};var Desactive=function Desactive(e){e.preventDefault();if(active){dispatch(profileUpdateInfo(_objectSpread(_objectSpread({},showDeleteProfileInfo),{},{activo:'SI'})));return;}dispatch(profileUpdateInfo(_objectSpread(_objectSpread({},showDeleteProfileInfo),{},{activo:'NO',fecha_baja:format(new Date(),'yyyy-MM-dd')})));};return/*#__PURE__*/_jsx(_Fragment,{children:loadingUserListByProfileId?/*#__PURE__*/_jsx(_Fragment,{children:\"Cargando Perfil\"}):userListByProfileIdData&&userListByProfileIdData.length>0?/*#__PURE__*/_jsx(ActiveAndDesactiveActionModal,{open:deleteProfileModal,handleCloseModal:handleCloseDeleteProfileModal,handleSubmit:Desactive,message:/*#__PURE__*/_jsxs(_Fragment,{children:[\"El perfil \",/*#__PURE__*/_jsx(\"strong\",{children:showDeleteProfileInfo.codigo_perfil}),\" tiene asociados puestos de trabajo o gestores y solo puede \",active?'activar':'desactivar']}),modalTitle:\"\".concat(active?'Activar':'Desactivar',\" Perfil\"),error:errorProfileUpdate,success:successProfileUpdate,loading:loadingProfileUpdate,loadingMessageButton:active?'Activando...':'Desactivando',succesMessageButton:active?'Activar':'Desactivar'}):/*#__PURE__*/_jsx(DeleteActionModal,{open:deleteProfileModal,handleCloseModal:handleCloseDeleteProfileModal,handleSubmit:handleDeleteProfile,modalTitle:\"Eliminar Perfil\",showDeleteInfo:showDeleteProfileInfo===null||showDeleteProfileInfo===void 0?void 0:showDeleteProfileInfo.codigo_perfil,loadingDelete:loadingProfileDelete,successDelete:successProfileDelete,errorDelete:errorProfileDelete})});};export default DeleteProfileModal;","map":{"version":3,"names":["useEffect","useDispatch","useSelector","format","DeleteActionModal","ActiveAndDesactiveActionModal","deleteProfile","profileUpdateInfo","USER_LIST_BY_PROFILE_ID_RESET","PROFILE_LIST_RESET","PROFILE_DELETE_RESET","PROFILE_UPDATE_RESET","getUsersByProfileId","Fragment","_Fragment","jsx","_jsx","jsxs","_jsxs","DeleteProfileModal","_ref","handleCloseDeleteProfileModal","deleteProfileModal","showDeleteProfileInfo","dispatch","active","activo","_useSelector","state","profileDelete","successProfileDelete","errorProfileDelete","loadingProfileDelete","_useSelector2","userListByProfileId","loadingUserListByProfileId","userListByProfileIdData","_useSelector3","profileUpdate","loadingProfileUpdate","errorProfileUpdate","successProfileUpdate","timeOut","type","setTimeout","clearTimeout","id_perfil","handleDeleteProfile","e","preventDefault","Desactive","_objectSpread","fecha_baja","Date","children","length","open","handleCloseModal","handleSubmit","message","codigo_perfil","modalTitle","concat","error","success","loading","loadingMessageButton","succesMessageButton","showDeleteInfo","loadingDelete","successDelete","errorDelete"],"sources":["C:/trabajo/Alehope/actividadesPreBuild/Frontend/src/screens/control-panel/Catalog/Profile/ProfileListScreen/components/DeleteModal/DeleteProfileModal.js"],"sourcesContent":["import { useEffect } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { format } from 'date-fns'\r\nimport DeleteActionModal from 'components/ReactTableActions/Delete/DeleteActionModal'\r\nimport ActiveAndDesactiveActionModal from 'components/ReactTableActions/ActiveAndDesactive/ActiveAndDesactiveActionModal'\r\nimport { deleteProfile, profileUpdateInfo } from 'redux/actions/profileActions'\r\nimport { USER_LIST_BY_PROFILE_ID_RESET } from 'redux/constants/userConstants'\r\nimport { PROFILE_LIST_RESET, PROFILE_DELETE_RESET, PROFILE_UPDATE_RESET } from 'redux/constants/profileConstants'\r\nimport { getUsersByProfileId } from 'redux/actions/userActions'\r\n\r\nconst DeleteProfileModal = ({ handleCloseDeleteProfileModal, deleteProfileModal, showDeleteProfileInfo }) => {\r\n  const dispatch = useDispatch()\r\n  const active = showDeleteProfileInfo.activo !== 'SI'\r\n\r\n  const { successProfileDelete, errorProfileDelete, loadingProfileDelete } = useSelector((state) => state.profileDelete)\r\n  const { loadingUserListByProfileId, userListByProfileIdData } = useSelector((state) => state.userListByProfileId)\r\n  const { loadingProfileUpdate, errorProfileUpdate, successProfileUpdate } = useSelector((state) => state.profileUpdate)\r\n\r\n  useEffect(() => {\r\n    let timeOut = ''\r\n    if (successProfileUpdate) {\r\n      dispatch({ type: PROFILE_LIST_RESET })\r\n      timeOut = setTimeout(() => {\r\n        dispatch({ type: PROFILE_UPDATE_RESET })\r\n        handleCloseDeleteProfileModal()\r\n      }, 1000)\r\n    }\r\n\r\n    return () => clearTimeout(timeOut)\r\n  }, [successProfileUpdate])\r\n\r\n  useEffect(() => {\r\n    dispatch(getUsersByProfileId(showDeleteProfileInfo.id_perfil))\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    let timeOut = ''\r\n    if (successProfileDelete) {\r\n      timeOut = setTimeout(() => {\r\n        dispatch({ type: PROFILE_LIST_RESET })\r\n        dispatch({ type: PROFILE_DELETE_RESET })\r\n        handleCloseDeleteProfileModal()\r\n      }, 1000)\r\n    }\r\n    return () => clearTimeout(timeOut)\r\n  }, [successProfileDelete])\r\n\r\n  useEffect(() => {\r\n    return () => dispatch({ type: PROFILE_DELETE_RESET })\r\n  }, [dispatch])\r\n  useEffect(() => {\r\n    return () => dispatch({ type: PROFILE_UPDATE_RESET })\r\n  }, [dispatch])\r\n  useEffect(() => {\r\n    return () => dispatch({ type: USER_LIST_BY_PROFILE_ID_RESET })\r\n  }, [dispatch])\r\n\r\n  const handleDeleteProfile = (e) => {\r\n    e.preventDefault()\r\n    dispatch(deleteProfile(showDeleteProfileInfo?.id_perfil))\r\n  }\r\n\r\n  const Desactive = (e) => {\r\n    e.preventDefault()\r\n    if (active) {\r\n      dispatch(profileUpdateInfo({ ...showDeleteProfileInfo, activo: 'SI' }))\r\n      return\r\n    }\r\n    dispatch(\r\n      profileUpdateInfo({ ...showDeleteProfileInfo, activo: 'NO', fecha_baja: format(new Date(), 'yyyy-MM-dd') })\r\n    )\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {loadingUserListByProfileId ? (\r\n        <>Cargando Perfil</>\r\n      ) : userListByProfileIdData && userListByProfileIdData.length > 0 ? (\r\n        <ActiveAndDesactiveActionModal\r\n          open={deleteProfileModal}\r\n          handleCloseModal={handleCloseDeleteProfileModal}\r\n          handleSubmit={Desactive}\r\n          message={\r\n            <>\r\n              El perfil <strong>{showDeleteProfileInfo.codigo_perfil}</strong> tiene asociados puestos de trabajo o gestores y solo\r\n              puede {active ? 'activar' : 'desactivar'}\r\n            </>\r\n          }\r\n          modalTitle={`${active ? 'Activar' : 'Desactivar'} Perfil`}\r\n          error={errorProfileUpdate}\r\n          success={successProfileUpdate}\r\n          loading={loadingProfileUpdate}\r\n          loadingMessageButton={active ? 'Activando...' : 'Desactivando'}\r\n          succesMessageButton={active ? 'Activar' : 'Desactivar'}\r\n        />\r\n      ) : (\r\n        <DeleteActionModal\r\n          open={deleteProfileModal}\r\n          handleCloseModal={handleCloseDeleteProfileModal}\r\n          handleSubmit={handleDeleteProfile}\r\n          modalTitle='Eliminar Perfil'\r\n          showDeleteInfo={showDeleteProfileInfo?.codigo_perfil}\r\n          loadingDelete={loadingProfileDelete}\r\n          successDelete={successProfileDelete}\r\n          errorDelete={errorProfileDelete}\r\n        />\r\n      )}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default DeleteProfileModal\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}